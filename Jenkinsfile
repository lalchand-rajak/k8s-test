pipeline {

  agent any
  options {
    disableConcurrentBuilds()  //each branch has 1 job running at a time
  }
  stages {

    stage('Checkout Source') {
      steps {
        git url:'https://github.com/lalchand-rajak/k8s-test.git', branch:'main'
      }
    }
    
    
  
    stage('Deploy Kubernetes ') {
kubernetesDeploy configs: 'config', enableConfigSubstitution: false, kubeConfig: [path: '/root/.kube'], kubeconfigId: 'test-cluster', secretName: '', ssh: [sshCredentialsId: 'k8s-deploy', sshServer: '10.210.0.133'], textCredentials: [certificateAuthorityData: 'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeE1Ea3dNVEUxTVRNMU4xb1hEVE14TURnek1ERTFNVE0xTjFvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBS2w4CjRCb0txVzZsdXBrb3ZnbDZTOG43dmhNd3NmWTh3ZTMzdVZmN3JYUWk0eEF6enN1VzFySVk3MG8xUXNxQkQyaDIKYTQxMnR3dEJEU2VRT2k4MklhNFZmZmUzWnVQNjZNRitNTXA4U3dpelg2UFFCZUp2U0ZQTlZ3VXZ0TkhYYzhIbgoyZnRCZENxQllRYnBwenBsSU9BNkhOdmx1ZVFoeUxJblpSMjFoRkJ4U25uWG84VWFtY08wU1YwYlhsdDVEcTB6ClpuUXBaT05sczRxOENiZFJmQUJjKzB3Ny9yQUJoSDN1ZlNPYXlSb0JxSmVudTh4Vm5PNjlYYllLMHdoQ2VBSXcKeTNQblBNb0I3Z0dnUGVER1pwejZCWGI1bVlvd3g0c1dZaXFXVEcyR01BejdDY2lNcFBEYktLSno1T3l3a2hxUwpCNzZmWGJ6QmhLcnd1K0dDeExzQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZIbmpnVmtQTHBUTWh2eHlEcVFtNHVRUFBaR0RNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFBb1h2T3BQUWZMVHlibkgyNWQ3VXd3QUpBeFlGWXZkdTc1SFJZQTZQdTdwR1AwUkc2TwpTOVNSeTJHbGMxdGJFQmdpc0lrSGFpanhmbGN4VTVEa0lCUjh4WnM2MUZTT2dPYnR2QkNNNy9JM3RMdGtwbFlZCm8rcDNQYXgzTVdNZS83bGd4bUFmdHRNc05MM0VUUElkMkhQNll3RVY5SEd2dmY3NFRHeFhxQ3FRTWdRWGlJQ2QKRWhHRkVSc2VFR1haVU5rd0Q3ZFowUzBWMS9WVUx1M29pZTg5ZjJFb3ZPenpENkEyNUxmSFJ0ZDBpbkdBeDVhMQpsTzY5MzJ3MjA5eUtCZ2o5Rmw1RmVjZkhGdlBnbE9meEJSOUkzMVk4QVpLUUJSczIyRGppV2lIQytCVkFmV0RXCnkrTGpUN05JRzNrTXZwbGY0ZXplODFmdXllTG5NQSt5RVRoYgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==', clientCertificateData: ' LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURFekNDQWZ1Z0F3SUJBZ0lJVGlIb25VaWY0em93RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TVRBNU1ERXhOVEV6TlRkYUZ3MHlNakE1TURFeE5URTBNREZhTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXIwaFFQa2h6dUVxeVJGbTYKakh3VVVlK1F0TVlsSnN5d21qN0U5L3Fkc2ppUXJTM3pHVk96T0d6YVNyUzkxWDVVTnJqTWxLOFpSbUZDWjNDSgpaNnRTTFZtbEhSTkVnYzF2Q2Z6S3lodFcwckFaWUpURmFCVmxwN20zZFFmQyt6UnhBdUd3bCt4SEU1R3JweWRBClRrMGpSbk9wWVJFclBaSXVxcVMyZFJXSGFVRjl4Tlg1MDBMREhpdXFQc0tzbnJvRHdOdkJ0c1hBeWFrTnM5Vk4KeVprVXdUMTFsMWlwVXdhNGt6dWtvZndTUzdsdVVDMll6bDV5WEQ2LzY1Z1ZyYkw0WmtDSXZDdHJRNFZUQUNYUgpISHlBVWtLUnl4NmdlVUlrcjdRMytpcjhoM1g5THNFb1N2cC9RZkVoUnJqRFBkblRiWTJCSXBFK3FCS3dmNGtPClBaYU1qUUlEQVFBQm8wZ3dSakFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0h3WURWUjBqQkJnd0ZvQVVlZU9CV1E4dWxNeUcvSElPcENiaTVBODlrWU13RFFZSktvWklodmNOQVFFTApCUUFEZ2dFQkFJVEhXRlFSSC9Pd0s3Q3BpcUozMTJvNUVwdkd5NXVjNTg4Rk5BUkVDREdDN3hZZDdNVWR3NUVWCmNlaC81YVZlR0h0aHNqdVhmd1VYcE9tMWh2ZUovSWdGV042N3RqWUsvdzZWeTNnaWlSZkFSVVZpSmZFSkNKQksKR1JzZmViQ25kSjVXNUZZa0wyd2hYMjN6Z2pqRGNva05rZFgzNy8yd28vRGlpOXQ5cWZkWFVndnNZU1RwVEp0SwpPZ0NsMmxNRmVMZmNUVFBBcW5WazdFaUpZWGhpNm9qUjBxdlJFUUxGOEltdVZpa2hmc2pzRHZyRmg0WXkxcjhKCnhuMmNFajE1aXlLb21xTWNhL1JBMEx5UlhjWXpwMWY1SFZvRDRabDUxSzhRS3dvSnVkM2pmaGdjUW1NdGo3aWoKMWpETGZTZDVyczlFNGJPdGQrYmF0OTUwcFNUM2o3dz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=', clientKeyData: ' LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBcjBoUVBraHp1RXF5UkZtNmpId1VVZStRdE1ZbEpzeXdtajdFOS9xZHNqaVFyUzN6CkdWT3pPR3phU3JTOTFYNVVOcmpNbEs4WlJtRkNaM0NKWjZ0U0xWbWxIUk5FZ2MxdkNmekt5aHRXMHJBWllKVEYKYUJWbHA3bTNkUWZDK3pSeEF1R3dsK3hIRTVHcnB5ZEFUazBqUm5PcFlSRXJQWkl1cXFTMmRSV0hhVUY5eE5YNQowMExESGl1cVBzS3Nucm9Ed052QnRzWEF5YWtOczlWTnlaa1V3VDExbDFpcFV3YTRrenVrb2Z3U1M3bHVVQzJZCnpsNXlYRDYvNjVnVnJiTDRaa0NJdkN0clE0VlRBQ1hSSEh5QVVrS1J5eDZnZVVJa3I3UTMraXI4aDNYOUxzRW8KU3ZwL1FmRWhScmpEUGRuVGJZMkJJcEUrcUJLd2Y0a09QWmFNalFJREFRQUJBb0lCQUZ0bkt5ai9ZUkRHS3VYSApvS2JuZ1RVazV1SE52Y3ZZeTNMenJvVGR0R1FlYVJ0VnJjSVVTbzN1L1hvZGZDeWJYdERXVnlCbG1wbC8yRC9XCmlHQitEekZFNFB3amN3TDVIS0VwcUpueDNibXFTT0Y3VXVHdTNyNnk4cjdkV0Vqa2xOWDYyTHF3WkhRSTcya1AKNTlHdEdlc0FIMkJWc3FXOTJBWDJOSXNqdWVRaGZISU5scHU0ZHROTzl3TkhMN1JRWThLZ3JUS1lIc3RxVlZPTgpidHhKWnp3WFRqL3IzZGptS1UwWjM5VW1wNXFkaDBXdzNIMHhxNEpWVDlyd2VLTTlBbXNneVFkWGFLYXZhTjZQCitQd0hMeSt1YlIveXdnOHR6R1BUQldZQ0ovTmpEVHpvOUt0ZmZ3Zm45d0g4d09iaFhMVFNMeU9MUnlia1EyRDEKV0s5ckp3VUNnWUVBeUptNWJYT1ZBUUY3SWRzd2N0OUMrYXViOURkWmYwZ2dHNnFlT3N2SlFRbktlaEtvV2VlbApBNDl5NEtjRWFGb0tCWUdZaUhONWNqbUtQOTFYQzRnOWRQM09NMVQraWVwbENFeEsrUjRGSWduWE5heThXOG9YClBNcE95OU9vQXBzUThiM281dU51YzBCb1hUNCt3S0o3N0lyWllDellEcU5XNmN3Y2RWUlNMcmNDZ1lFQTM3Q2cKMXVJS3BBbTViQWpEK3QrWHN1OHJnUG9FRGg5SXJ1OExQQTcwMThtMU12aXZDZHh5MWxFeGhLY0hXK2pwazZWQgpGU0pCUm00REVnVkhEdFo0ZVlxZ09LNmdsM0ZTTnRaR3lsU25vVmw2bk5nb2NGZG40bmZSSGVpQmNzeWVWSC9ZCjlJMm0zSE4yYzRXUmRSZW5NZzRQdit6amQ5NllMWGRkVldmR0d0c0NnWUErcE5MbFBUMEE3V2Q0Y1N5MkVzYWwKbFZQRWRpeDZ0UmxoeW14VFRDUnpMUTJRQlplUlMrZWFMd2ZlNUFsYVZSUGdHRko3K2lPbzZoTWtVb2pHVHl0eQpCM2lIU3ptWjlCck05cFpMS1hiTTVHblNsempUS1U4TWF0a2tpZHBqeGUwS3NSVzBWTDIvUEJQYlduN2FSV09SCndPS1ZTQ3ZJbG5XajJWdmh3QTFTRFFLQmdRQ1Z5YVBhWUtENWVWMkZ2MVRrc0ViWDFob09rdHlXVEZLU2VaWFAKVU1DWm93TklMNGllbE5UOU9IOXRNWi9XNXQ5S00vV2gzajlSbHlkTk1PV0ZSUTZGYk5PZlFTaGVZTTdKMDdDeAptZ0JxSmczWjYxRWc4UmFxYXN0SU9NSStDbERYaW9qUU1lNlRYbW5xTDMzWXA4OFkwSnV4VEVLQnFUZkQ4bE00CmRuWU0wd0tCZ1FDS2ZSaENaSE02b20xWnh0QldvOHZ0MHNSNjQ1V1VvODdaM0pwaEQvYXg1U0dmL2c4Z0NUczMKYk1ieVd5UVhxRjFMbHNadkFXblhvNjNrLzEyQU9pZlVJUXpPRUpzeTl1UU1jYkhJNWhpbzdwMkkxUTR1cGI5TAp2Um5xOGtTSHlWUmxrM2JFTWw4aHRnWlJON0h4OFYzWUd2RFQyZkQrRWllNnE4cHMxK0RITHc9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=', serverUrl: ' https://10.210.0.133:6443']
           
           sh 'kubectl apply -f nginx.yaml'
           
            }
              
        }
    }
} 

     
    
